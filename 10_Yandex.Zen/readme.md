# Аналитика в Яндекс.Дзен

---

Библиотеки:

**`sys`**  **`getopt`**  **`pandas`**  **`sqlalchemy`**  **`matplotlib`**  **`plotly`**  **`dash`**  **`dash_core_components`**  **`dash_html_components`**  **`datetime`**

---

Необходимо автоматизировать анализ пользовательского взаимодействия с карточками статей Яндекс.Дзен:

- Сколько взаимодействий пользователей с карточками происходит в системе с разбивкой по темам карточек?
- Как много карточек генерируют источники с разными темами?
- Насколько хорошо пользователи конвертируются из показов карточек в просмотры статей?

### Краткое ТЗ для построения дашборда:

- Бизнес-задача: анализ взаимодействия пользователей с карточками Яндекс.Дзен;
- Насколько часто предполагается пользоваться дашбордом: не реже, чем раз в неделю;
- Кто будет основным пользователем дашборда: менеджеры по анализу контента;
- Состав данных для дашборда:
    - История событий по темам карточек;
    - Разбивка событий по темам источников;
    - Глубина взаимодействия пользователей с карточками (воронка: показ — клик — просмотр);
- По каким параметрам данные должны группироваться:
    - Дата и время;
    - Тема карточки;
    - Тема источника;
    - Возрастная группа;
    - Тип события;
- Характер данных:
    - История событий по темам карточек — абсолютные величины с разбивкой по минутам;
    - Разбивка событий по темам источников — относительные величины (% событий);
    - Глубина взаимодействия пользователей с карточками — относительные величины (средний % от показов);
- Важность: график истории событий по темам карточек важнее всего, он должен занимать не меньше половины площади дашборда;
- Источники данных для дашборда: cырые данные о событиях взаимодействия пользователей с карточками;
- База данных, в которой будут храниться агрегированные данные: дополнительные агрегированные таблицы в БД;
- Частота обновления данных: один раз в сутки, в полночь по *UTC*;
- Какие графики должны отображаться и в каком порядке, какие элементы управления должны быть на дашборде (макет дашборда):

![https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/Files/dasboard_scheme.png](https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/Files/dasboard_scheme.png)

### Краткое описание проделанной работы и полученных результатов

Работу над этим проектом я провел на удаленной машине в сервисе *Yandex.Cloud*. Мной был установлен *PostgreSQL*, развернута база данных. Затем я написал скрипт пайплайна, который позволил собирать данные за определенный временной период, и настроил его автономную работу через *crontab* с записью логов в папку *logs*. Для визуализации собранных данных я написал скрипт дашборда с несколькими фильтрами и также запустил его на удаленной машине. По результатам была подготовлена презентация с полученными графиками

Для презентации результатов работы был взят 1 час: с 18:00:00 по 19:00:00 2019-09-24

___
[Изучить код пайплайна](https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/zen_pipeline.py)

Команда для *crontab* (скрипт будет запускаться каждый день в 4:15 *UTC+0*):

```BASH
15 4 * * * python3 -u -W ignore /home/code/zen_pipeline.py --start_dt=$(date +\%Y-\%m-\%d\ %H:%M:00 -d "1 day ago")
--end_dt=$(date +\%Y-\%m-\%d\ %H:%M:00) >> /home/code/logs/zen_pipeline_$(date +\%Y-\%m-\%d).log 2>&1
```
___

[Изучить код дашборда](https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/zen_dash.py)

[Посмотреть снимок дашборда](https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/Dash.pdf)
___

[Перейти к презентации](https://github.com/itstony-k/ya_praktikum/blob/master/10_Yandex.Zen/Presentation.pdf)
